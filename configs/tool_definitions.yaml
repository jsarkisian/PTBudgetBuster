# Tool definitions for the MCP-PT server
# Each tool has a name, description, binary path, and parameter schema

tools:
  subfinder:
    name: subfinder
    description: "Subdomain discovery tool using passive sources"
    binary: /root/go/bin/subfinder
    category: reconnaissance
    risk_level: low
    default_args: ["-silent"]
    parameters:
      domain:
        type: string
        required: true
        flag: "-d"
        description: "Target domain"
      sources:
        type: string
        required: false
        flag: "-sources"
        description: "Comma-separated list of sources"
      output:
        type: string
        required: false
        flag: "-o"
        description: "Output file path"
      recursive:
        type: boolean
        required: false
        flag: "-recursive"
        description: "Enable recursive subdomain discovery"
      timeout:
        type: integer
        required: false
        flag: "-timeout"
        description: "Timeout in seconds"

  httpx:
    name: httpx
    description: "HTTP probe tool for finding live web servers. Also supports screenshots with -screenshot flag."
    binary: /root/go/bin/httpx
    category: reconnaissance
    risk_level: low
    default_args: ["-silent"]
    parameters:
      target:
        type: string
        required: false
        flag: "-u"
        description: "Single target URL"
      list:
        type: string
        required: false
        flag: "-l"
        description: "Input file with list of targets"
      stdin_targets:
        type: string
        required: false
        stdin: true
        description: "Pipe targets via stdin (one per line)"
      ports:
        type: string
        required: false
        flag: "-ports"
        description: "Custom ports to probe"
      status_code:
        type: boolean
        required: false
        flag: "-status-code"
        description: "Show status codes"
      title:
        type: boolean
        required: false
        flag: "-title"
        description: "Show page titles"
      tech_detect:
        type: boolean
        required: false
        flag: "-tech-detect"
        description: "Detect technologies"
      follow_redirects:
        type: boolean
        required: false
        flag: "-follow-redirects"
        description: "Follow HTTP redirects"
      screenshot:
        type: boolean
        required: false
        flag: "-screenshot"
        description: "Take screenshots of web pages"
      screenshot_path:
        type: string
        required: false
        flag: "-screenshot-path"
        description: "Path to save screenshots (default: ./output/screenshot)"
      output:
        type: string
        required: false
        flag: "-o"
        description: "Output file path"

  nuclei:
    name: nuclei
    description: "Vulnerability scanner using YAML templates"
    binary: /root/go/bin/nuclei
    category: vulnerability_scanning
    risk_level: medium
    default_args: ["-silent"]
    parameters:
      target:
        type: string
        required: false
        flag: "-u"
        description: "Single target URL"
      list:
        type: string
        required: false
        flag: "-l"
        description: "Input file with list of targets"
      templates:
        type: string
        required: false
        flag: "-t"
        description: "Template or directory to use"
      tags:
        type: string
        required: false
        flag: "-tags"
        description: "Filter templates by tags"
      severity:
        type: string
        required: false
        flag: "-severity"
        description: "Filter by severity (info,low,medium,high,critical)"
      output:
        type: string
        required: false
        flag: "-o"
        description: "Output file path"
      json_output:
        type: boolean
        required: false
        flag: "-jsonl"
        description: "Output in JSONL format"
      rate_limit:
        type: integer
        required: false
        flag: "-rate-limit"
        description: "Max requests per second"

  naabu:
    name: naabu
    description: "Fast port scanner"
    binary: /root/go/bin/naabu
    category: reconnaissance
    risk_level: low
    default_args: ["-silent"]
    parameters:
      host:
        type: string
        required: false
        flag: "-host"
        description: "Target host"
      list:
        type: string
        required: false
        flag: "-list"
        description: "Input file with list of hosts"
      ports:
        type: string
        required: false
        flag: "-p"
        description: "Ports to scan (e.g., 80,443,8080 or 1-1000)"
      top_ports:
        type: string
        required: false
        flag: "-top-ports"
        description: "Scan top N ports (100, 1000)"
      output:
        type: string
        required: false
        flag: "-o"
        description: "Output file path"
      rate:
        type: integer
        required: false
        flag: "-rate"
        description: "Packet send rate"

  nmap:
    name: nmap
    description: "Network mapper and port scanner with advanced features"
    binary: /usr/bin/nmap
    category: reconnaissance
    risk_level: medium
    default_args: []
    parameters:
      target:
        type: string
        required: true
        positional: true
        description: "Target host or network"
      ports:
        type: string
        required: false
        flag: "-p"
        description: "Port specification"
      scan_type:
        type: string
        required: false
        flag: ""
        description: "Scan type flag (e.g., -sV, -sS, -sC)"
        raw_flag: true
      output_xml:
        type: string
        required: false
        flag: "-oX"
        description: "XML output file"
      output_normal:
        type: string
        required: false
        flag: "-oN"
        description: "Normal output file"
      scripts:
        type: string
        required: false
        flag: "--script"
        description: "NSE scripts to run"
      timing:
        type: string
        required: false
        flag: "-T"
        description: "Timing template (0-5)"

  katana:
    name: katana
    description: "Web crawler for discovering endpoints and URLs"
    binary: /root/go/bin/katana
    category: reconnaissance
    risk_level: low
    default_args: ["-silent"]
    parameters:
      target:
        type: string
        required: true
        flag: "-u"
        description: "Target URL"
      depth:
        type: integer
        required: false
        flag: "-d"
        description: "Crawl depth"
      output:
        type: string
        required: false
        flag: "-o"
        description: "Output file path"
      js_crawl:
        type: boolean
        required: false
        flag: "-jc"
        description: "Enable JavaScript crawling"

  dnsx:
    name: dnsx
    description: "DNS toolkit for running multiple DNS queries"
    binary: /root/go/bin/dnsx
    category: reconnaissance
    risk_level: low
    default_args: ["-silent"]
    parameters:
      domain:
        type: string
        required: false
        flag: "-d"
        description: "Target domain"
      list:
        type: string
        required: false
        flag: "-l"
        description: "Input file with list of domains"
      record_type:
        type: string
        required: false
        flag: "-"
        description: "Record type (a, aaaa, cname, mx, ns, txt, srv, ptr)"
        raw_flag: true
      output:
        type: string
        required: false
        flag: "-o"
        description: "Output file path"

  tlsx:
    name: tlsx
    description: "TLS/SSL certificate analyzer"
    binary: /root/go/bin/tlsx
    category: reconnaissance
    risk_level: low
    default_args: ["-silent"]
    parameters:
      host:
        type: string
        required: false
        flag: "-u"
        description: "Target host"
      list:
        type: string
        required: false
        flag: "-l"
        description: "Input file with list of hosts"
      san:
        type: boolean
        required: false
        flag: "-san"
        description: "Show Subject Alternative Names"
      cn:
        type: boolean
        required: false
        flag: "-cn"
        description: "Show Common Name"
      expired:
        type: boolean
        required: false
        flag: "-expired"
        description: "Show only expired certs"

  ffuf:
    name: ffuf
    description: "Fast web fuzzer for directory/file discovery"
    binary: /root/go/bin/ffuf
    category: discovery
    risk_level: medium
    default_args: []
    parameters:
      url:
        type: string
        required: true
        flag: "-u"
        description: "Target URL with FUZZ keyword"
      wordlist:
        type: string
        required: true
        flag: "-w"
        description: "Wordlist path"
      method:
        type: string
        required: false
        flag: "-X"
        description: "HTTP method"
      filter_code:
        type: string
        required: false
        flag: "-fc"
        description: "Filter status codes"
      match_code:
        type: string
        required: false
        flag: "-mc"
        description: "Match status codes"
      rate:
        type: integer
        required: false
        flag: "-rate"
        description: "Requests per second"
      output:
        type: string
        required: false
        flag: "-o"
        description: "Output file path"

  gowitness:
    name: gowitness
    description: "Web screenshot tool"
    binary: /root/go/bin/gowitness
    category: reconnaissance
    risk_level: low
    default_args: []
    parameters:
      url:
        type: string
        required: false
        flag: ""
        description: "Target URL (used with 'single' subcommand)"
      file:
        type: string
        required: false
        flag: "-f"
        description: "Input file with URLs"
      subcommand:
        type: string
        required: true
        description: "Subcommand: single, file, scan"
      screenshot_path:
        type: string
        required: false
        flag: "--screenshot-path"
        description: "Path to save screenshots"

  waybackurls:
    name: waybackurls
    description: "Fetch URLs from the Wayback Machine"
    binary: /root/go/bin/waybackurls
    category: reconnaissance
    risk_level: low
    default_args: []
    parameters:
      domain:
        type: string
        required: true
        positional: true
        description: "Target domain (passed via stdin/pipe)"
        stdin: true

  whatweb:
    name: whatweb
    description: "Web technology fingerprinter"
    binary: /usr/bin/whatweb
    category: reconnaissance
    risk_level: low
    default_args: []
    parameters:
      target:
        type: string
        required: true
        positional: true
        description: "Target URL"
      aggression:
        type: integer
        required: false
        flag: "-a"
        description: "Aggression level (1-4)"

  wafw00f:
    name: wafw00f
    description: "Web Application Firewall detection tool"
    binary: /usr/bin/wafw00f
    category: reconnaissance
    risk_level: low
    default_args: []
    parameters:
      target:
        type: string
        required: true
        positional: true
        description: "Target URL"
      all_waf:
        type: boolean
        required: false
        flag: "-a"
        description: "Test for all WAFs"

  sslscan:
    name: sslscan
    description: "SSL/TLS configuration scanner"
    binary: /usr/bin/sslscan
    category: reconnaissance
    risk_level: low
    default_args: []
    parameters:
      target:
        type: string
        required: true
        positional: true
        description: "Target host:port"
      no_color:
        type: boolean
        required: false
        flag: "--no-colour"
        description: "Disable color output"
      xml:
        type: string
        required: false
        flag: "--xml"
        description: "XML output file"

  nikto:
    name: nikto
    description: "Web server vulnerability scanner"
    binary: /usr/bin/nikto
    category: vulnerability_scanning
    risk_level: high
    default_args: []
    parameters:
      host:
        type: string
        required: true
        flag: "-h"
        description: "Target host"
      port:
        type: integer
        required: false
        flag: "-p"
        description: "Target port"
      output:
        type: string
        required: false
        flag: "-o"
        description: "Output file"
      format:
        type: string
        required: false
        flag: "-Format"
        description: "Output format (csv, htm, msf+, nbe, sql, txt, xml)"
      tuning:
        type: string
        required: false
        flag: "-Tuning"
        description: "Scan tuning options"

  masscan:
    name: masscan
    description: "Ultra-fast port scanner for large networks"
    binary: /usr/bin/masscan
    category: reconnaissance
    risk_level: high
    default_args: []
    parameters:
      target:
        type: string
        required: true
        positional: true
        description: "Target IP range"
      ports:
        type: string
        required: true
        flag: "-p"
        description: "Port specification"
      rate:
        type: integer
        required: false
        flag: "--rate"
        description: "Packet send rate"
      output:
        type: string
        required: false
        flag: "-oL"
        description: "List output file"


  gobuster:
    name: gobuster
    description: "Directory/file brute-forcing and DNS subdomain enumeration"
    binary: /usr/bin/gobuster
    category: discovery
    risk_level: medium
    default_args: []
    parameters:
      mode:
        type: string
        required: true
        description: "Mode: dir, dns, vhost, fuzz, s3, gcs, tftp"
      url:
        type: string
        required: false
        flag: "-u"
        description: "Target URL (for dir/vhost mode)"
      domain:
        type: string
        required: false
        flag: "-d"
        description: "Target domain (for dns mode)"
      wordlist:
        type: string
        required: false
        flag: "-w"
        description: "Wordlist path (default: /usr/share/seclists/Discovery/Web-Content/common.txt)"
      threads:
        type: integer
        required: false
        flag: "-t"
        description: "Number of threads"
      output:
        type: string
        required: false
        flag: "-o"
        description: "Output file"

  sqlmap:
    name: sqlmap
    description: "Automatic SQL injection detection and exploitation"
    binary: /usr/bin/sqlmap
    category: exploitation
    risk_level: high
    default_args: ["--batch"]
    parameters:
      url:
        type: string
        required: false
        flag: "-u"
        description: "Target URL with parameter"
      request_file:
        type: string
        required: false
        flag: "-r"
        description: "Load HTTP request from file"
      dbs:
        type: boolean
        required: false
        flag: "--dbs"
        description: "Enumerate databases"
      tables:
        type: boolean
        required: false
        flag: "--tables"
        description: "Enumerate tables"
      level:
        type: integer
        required: false
        flag: "--level"
        description: "Level of tests (1-5)"
      risk:
        type: integer
        required: false
        flag: "--risk"
        description: "Risk of tests (1-3)"
      output_dir:
        type: string
        required: false
        flag: "--output-dir"
        description: "Output directory"

  hydra:
    name: hydra
    description: "Fast network login brute-forcer supporting many protocols"
    binary: /usr/bin/hydra
    category: exploitation
    risk_level: high
    default_args: []
    parameters:
      target:
        type: string
        required: true
        description: "Target host"
      service:
        type: string
        required: true
        flag: ""
        description: "Service to attack (ssh, ftp, http-get, etc.)"
      login:
        type: string
        required: false
        flag: "-l"
        description: "Single username"
      login_list:
        type: string
        required: false
        flag: "-L"
        description: "Username wordlist"
      password:
        type: string
        required: false
        flag: "-p"
        description: "Single password"
      password_list:
        type: string
        required: false
        flag: "-P"
        description: "Password wordlist"
      threads:
        type: integer
        required: false
        flag: "-t"
        description: "Number of threads"
      output:
        type: string
        required: false
        flag: "-o"
        description: "Output file"

  wpscan:
    name: wpscan
    description: "WordPress security scanner"
    binary: /usr/bin/wpscan
    category: vulnerability_scanning
    risk_level: medium
    default_args: ["--no-banner"]
    parameters:
      url:
        type: string
        required: true
        flag: "--url"
        description: "Target WordPress URL"
      enumerate:
        type: string
        required: false
        flag: "--enumerate"
        description: "Enumerate: p (plugins), t (themes), u (users), vp (vulnerable plugins)"
      output:
        type: string
        required: false
        flag: "-o"
        description: "Output file"
      format:
        type: string
        required: false
        flag: "-f"
        description: "Output format (cli, json)"

  enum4linux:
    name: enum4linux
    description: "Windows/SMB enumeration tool"
    binary: /usr/bin/enum4linux
    category: reconnaissance
    risk_level: medium
    default_args: []
    parameters:
      target:
        type: string
        required: true
        description: "Target IP address"
      all:
        type: boolean
        required: false
        flag: "-a"
        description: "Do all simple enumeration"
      users:
        type: boolean
        required: false
        flag: "-U"
        description: "Get userlist"
      shares:
        type: boolean
        required: false
        flag: "-S"
        description: "Get share list"

  smbclient:
    name: smbclient
    description: "SMB/CIFS client for accessing shared resources"
    binary: /usr/bin/smbclient
    category: reconnaissance
    risk_level: medium
    default_args: ["-N"]
    parameters:
      target:
        type: string
        required: true
        flag: "-L"
        description: "List shares on target"

  smbmap:
    name: smbmap
    description: "SMB share enumeration and access checker"
    binary: /usr/bin/smbmap
    category: reconnaissance
    risk_level: medium
    default_args: []
    parameters:
      host:
        type: string
        required: true
        flag: "-H"
        description: "Target host"
      username:
        type: string
        required: false
        flag: "-u"
        description: "Username"
      password:
        type: string
        required: false
        flag: "-p"
        description: "Password"
      domain:
        type: string
        required: false
        flag: "-d"
        description: "Domain"

  dnsrecon:
    name: dnsrecon
    description: "DNS enumeration and reconnaissance"
    binary: /usr/bin/dnsrecon
    category: reconnaissance
    risk_level: low
    default_args: []
    parameters:
      domain:
        type: string
        required: true
        flag: "-d"
        description: "Target domain"
      type:
        type: string
        required: false
        flag: "-t"
        description: "Scan type: std, brt, srv, axfr, rvl"
      output:
        type: string
        required: false
        flag: "-o"
        description: "Output file (CSV)"

  theharvester:
    name: theharvester
    description: "Email, subdomain, and people name harvester"
    binary: /usr/bin/theHarvester
    category: reconnaissance
    risk_level: low
    default_args: []
    parameters:
      domain:
        type: string
        required: true
        flag: "-d"
        description: "Target domain"
      source:
        type: string
        required: false
        flag: "-b"
        description: "Data source (google, bing, linkedin, all)"
      limit:
        type: integer
        required: false
        flag: "-l"
        description: "Limit results"

  amass:
    name: amass
    description: "Advanced subdomain enumeration and network mapping"
    binary: /usr/bin/amass
    category: reconnaissance
    risk_level: low
    default_args: []
    parameters:
      subcommand:
        type: string
        required: true
        description: "Subcommand: enum, intel, viz, track, db"
      domain:
        type: string
        required: false
        flag: "-d"
        description: "Target domain"
      passive:
        type: boolean
        required: false
        flag: "-passive"
        description: "Passive enumeration only"
      output:
        type: string
        required: false
        flag: "-o"
        description: "Output file"

  gospider:
    name: gospider
    description: "Fast web spider for crawling and link extraction"
    binary: /root/go/bin/gospider
    category: discovery
    risk_level: low
    default_args: []
    parameters:
      site:
        type: string
        required: true
        flag: "-s"
        description: "Target site URL"
      depth:
        type: integer
        required: false
        flag: "-d"
        description: "Crawl depth"
      concurrent:
        type: integer
        required: false
        flag: "-c"
        description: "Concurrent requests"
      output:
        type: string
        required: false
        flag: "-o"
        description: "Output directory"

  gau:
    name: gau
    description: "Fetch known URLs from AlienVault OTX, Wayback Machine, and Common Crawl"
    binary: /root/go/bin/gau
    category: reconnaissance
    risk_level: low
    default_args: []
    parameters:
      target:
        type: string
        required: true
        description: "Target domain"
      output:
        type: string
        required: false
        flag: "-o"
        description: "Output file"
      providers:
        type: string
        required: false
        flag: "--providers"
        description: "Providers: wayback, commoncrawl, otx, urlscan"

  crackmapexec:
    name: crackmapexec
    description: "Network pentest tool for SMB, WinRM, LDAP, MSSQL, SSH"
    binary: /usr/bin/crackmapexec
    category: exploitation
    risk_level: high
    default_args: []
    parameters:
      protocol:
        type: string
        required: true
        description: "Protocol: smb, winrm, ldap, mssql, ssh"
      target:
        type: string
        required: true
        description: "Target IP/range/CIDR"
      username:
        type: string
        required: false
        flag: "-u"
        description: "Username"
      password:
        type: string
        required: false
        flag: "-p"
        description: "Password"
      shares:
        type: boolean
        required: false
        flag: "--shares"
        description: "Enumerate shares"

  responder:
    name: responder
    description: "LLMNR/NBT-NS/MDNS poisoner for credential capture"
    binary: /usr/bin/responder
    category: exploitation
    risk_level: high
    default_args: []
    parameters:
      interface:
        type: string
        required: true
        flag: "-I"
        description: "Network interface"
      analyze:
        type: boolean
        required: false
        flag: "-A"
        description: "Analyze mode (passive, no poisoning)"

  nbtscan:
    name: nbtscan
    description: "NetBIOS name scanner"
    binary: /usr/bin/nbtscan
    category: reconnaissance
    risk_level: low
    default_args: []
    parameters:
      target:
        type: string
        required: true
        description: "Target IP/range (e.g., 192.168.1.0/24)"

  snmpwalk:
    name: snmpwalk
    description: "SNMP MIB tree walker for network device enumeration"
    binary: /usr/bin/snmpwalk
    category: reconnaissance
    risk_level: low
    default_args: ["-v2c"]
    parameters:
      target:
        type: string
        required: true
        description: "Target IP"
      community:
        type: string
        required: false
        flag: "-c"
        description: "Community string (default: public)"

  fierce:
    name: fierce
    description: "DNS reconnaissance tool for locating non-contiguous IP space"
    binary: /usr/bin/fierce
    category: reconnaissance
    risk_level: low
    default_args: []
    parameters:
      domain:
        type: string
        required: true
        flag: "--domain"
        description: "Target domain"
      subdomains:
        type: string
        required: false
        flag: "--subdomains"
        description: "Wordlist for subdomain brute-force"

  wfuzz:
    name: wfuzz
    description: "Web application fuzzer"
    binary: /usr/bin/wfuzz
    category: discovery
    risk_level: medium
    default_args: []
    parameters:
      url:
        type: string
        required: true
        flag: "-u"
        description: "Target URL with FUZZ keyword"
      wordlist:
        type: string
        required: true
        flag: "-w"
        description: "Wordlist path"
      hide_code:
        type: string
        required: false
        flag: "--hc"
        description: "Hide responses with these codes (e.g., 404)"

  testssl:
    name: testssl
    description: "Comprehensive SSL/TLS testing"
    binary: /usr/bin/testssl
    category: vulnerability_scanning
    risk_level: low
    default_args: []
    parameters:
      target:
        type: string
        required: true
        description: "Target host:port"
      output:
        type: string
        required: false
        flag: "--htmlfile"
        description: "Save HTML report"

  uncover:
    name: uncover
    description: "Discover exposed hosts using multiple search engines (Shodan, Censys, etc.)"
    binary: /root/go/bin/uncover
    category: reconnaissance
    risk_level: low
    default_args: ["-silent"]
    parameters:
      query:
        type: string
        required: true
        flag: "-q"
        description: "Search query"
      engine:
        type: string
        required: false
        flag: "-e"
        description: "Engine: shodan, censys, fofa, hunter, quake"
      limit:
        type: integer
        required: false
        flag: "-limit"
        description: "Result limit"
